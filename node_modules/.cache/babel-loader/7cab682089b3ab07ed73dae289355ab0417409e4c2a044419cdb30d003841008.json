{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/User/Documents/GitHub/assignment2-1-208897991_208009845/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/User/Documents/GitHub/assignment2-1-208897991_208009845/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\n// import { addFavorite, deleteFavorite } from \"../services/user.js\";\nexport default {\n  name: 'icons',\n  data: function data() {\n    return {\n      image_load: true,\n      isFavorite: false,\n      isViewed: false\n    };\n  },\n  props: {\n    recipe: {\n      required: true\n    }\n  },\n  computed: {\n    favoriteImage: function favoriteImage() {\n      return this.isFavorite ? require('@/assets/favorite-icon.png') : require('@/assets/not-favorite-icon.png');\n    }\n  },\n  created: function created() {\n    var _this = this;\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _this.isViewed = _this.checkIfViewed();\n            _context.next = 3;\n            return _this.checkIfFavorite();\n          case 3:\n            _this.isFavorite = _context.sent;\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }))();\n  },\n  methods: {\n    checkIfViewed: function checkIfViewed() {\n      var viewedRecipes = JSON.parse(localStorage.getItem('viewedRecipes')) || [];\n      return viewedRecipes.includes(this.recipe.id);\n    },\n    checkIfFavorite: function checkIfFavorite() {\n      var _this2 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var favoriteRecipes;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _this2.axios.get(_this2.$root.store.server_domain + '/users/favorites');\n            case 2:\n              favoriteRecipes = _context2.sent;\n              console.log(\"favoriteRecipes\", favoriteRecipes);\n              console.log(\"this.recipe.id\", _this2.recipe.id);\n              return _context2.abrupt(\"return\", favoriteRecipes.data.includes(_this2.recipe.id));\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }))();\n    },\n    toggleFavorite: function toggleFavorite() {\n      var _this3 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var action, username, serverResponse;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _this3.isFavorite = !_this3.isFavorite;\n              action = _this3.isFavorite ? _this3.addFavorite : _this3.deleteFavorite;\n              _context3.prev = 2;\n              username = _this3.$root.store.username;\n              _context3.next = 6;\n              return action(username, _this3.recipe.id);\n            case 6:\n              serverResponse = _context3.sent;\n              console.log(\"server response:\", serverResponse);\n              if (serverResponse.status === 200) {\n                console.log(serverResponse.data);\n                _this3.showToast(serverResponse.data, 'Success', 'success');\n              } else {\n                _this3.handleError(serverResponse);\n              }\n              _context3.next = 14;\n              break;\n            case 11:\n              _context3.prev = 11;\n              _context3.t0 = _context3[\"catch\"](2);\n              _this3.handleError(_context3.t0);\n            case 14:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, null, [[2, 11]]);\n      }))();\n    },\n    showToast: function showToast(message, title, variant) {\n      this.$bvToast.toast(message, {\n        title: title,\n        variant: variant,\n        solid: true\n      });\n    },\n    handleError: function handleError(error) {\n      console.error('Error updating favorite status:', error);\n      this.showToast('Error updating favorite status', 'Error', 'danger');\n    },\n    addFavorite: function addFavorite() {\n      var _this4 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var username, recipeId, response;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              username = _this4.$root.store.username;\n              recipeId = _this4.recipe.id;\n              console.log(username, recipeId);\n              _context4.next = 5;\n              return _this4.axios.post(_this4.$root.store.server_domain + '/users/favorites', {\n                \"username\": username,\n                \"recipeId\": recipeId\n              });\n            case 5:\n              response = _context4.sent;\n              return _context4.abrupt(\"return\", response);\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      }))();\n    },\n    deleteFavorite: function deleteFavorite() {\n      var _this5 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var username, recipeId, response;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              username = _this5.$root.store.username;\n              recipeId = _this5.recipe.id;\n              console.log(username, recipeId);\n              _context5.next = 5;\n              return _this5.axios[\"delete\"](_this5.$root.store.server_domain + '/users/favorites', {\n                data: {\n                  // 'data' is needed to send the body in DELETE requests\n                  \"username\": username,\n                  \"recipeId\": recipeId\n                }\n              });\n            case 5:\n              response = _context5.sent;\n              return _context5.abrupt(\"return\", response);\n            case 7:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5);\n      }))();\n    }\n  }\n};","map":{"version":3,"names":["name","data","image_load","isFavorite","isViewed","props","recipe","required","computed","favoriteImage","require","created","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","checkIfViewed","checkIfFavorite","sent","stop","methods","viewedRecipes","JSON","parse","localStorage","getItem","includes","id","_this2","_callee2","favoriteRecipes","_callee2$","_context2","axios","get","$root","store","server_domain","console","log","abrupt","toggleFavorite","_this3","_callee3","action","username","serverResponse","_callee3$","_context3","addFavorite","deleteFavorite","status","showToast","handleError","t0","message","title","variant","$bvToast","toast","solid","error","_this4","_callee4","recipeId","response","_callee4$","_context4","post","_this5","_callee5","_callee5$","_context5"],"sources":["src/components/Icons.vue"],"sourcesContent":["<template>\r\n    \r\n    <div class=\"footer-icons\">\r\n        <b-icon v-if=\"checkIfViewed()\" icon=\"eye\" class=\"viewed-icon\"></b-icon>\r\n        <span :to=\"{ name: 'recipe', params: { recipeId: recipe.id } }\" v-if=\"recipe.vegetarian\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ee/Vegetarian-mark.svg/1200px-Vegetarian-mark.svg.png\" class=\"vegi\" /></span>\r\n        <span v-if=\"recipe.vegan\"><img src=\"https://uxwing.com/wp-content/themes/uxwing/download/food-and-drinks/vegan-icon.png\" class=\"vegan\" /></span>\r\n        <span v-if=\"recipe.glutenFree\"><img src=\"https://cdn-icons-png.flaticon.com/512/4337/4337722.png\" class=\"glutenFree\" /></span>\r\n        \r\n\r\n        <label style=\"background-color: transparent;\">\r\n        <input type=\"checkbox\" @change=\"toggleFavorite\" class=\"custom-checkbox\"> \r\n        <img :src=\"favoriteImage\" alt=\"Favorite\" class=\"favorite-icon\">\r\n        </label>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n// import { addFavorite, deleteFavorite } from \"../services/user.js\";\r\nexport default {\r\n    name: 'icons',\r\n    data() {\r\n        return {\r\n            image_load: true,\r\n            isFavorite: false,\r\n            isViewed: false\r\n        };\r\n    },\r\n    props: {\r\n        recipe: {\r\n            required: true\r\n        }\r\n    },\r\n    computed: {\r\n        favoriteImage() {\r\n            return this.isFavorite ? require('@/assets/favorite-icon.png') : require('@/assets/not-favorite-icon.png');\r\n        }\r\n    },\r\n    async created() {\r\n        this.isViewed = this.checkIfViewed();\r\n        this.isFavorite = await this.checkIfFavorite();\r\n    },\r\n    methods: {\r\n        checkIfViewed() {\r\n            let viewedRecipes = JSON.parse(localStorage.getItem('viewedRecipes')) || [];\r\n            return viewedRecipes.includes(this.recipe.id);\r\n        },\r\n        async checkIfFavorite(){\r\n            const favoriteRecipes = await this.axios.get(this.$root.store.server_domain + '/users/favorites');\r\n            console.log(\"favoriteRecipes\",favoriteRecipes);\r\n            console.log(\"this.recipe.id\",this.recipe.id);\r\n            return favoriteRecipes.data.includes(this.recipe.id);\r\n        },\r\n        async toggleFavorite() {\r\n            this.isFavorite = !this.isFavorite;\r\n            const action = this.isFavorite ? this.addFavorite : this.deleteFavorite;\r\n\r\n            try {\r\n                const username = this.$root.store.username;\r\n                const serverResponse = await action(username, this.recipe.id);\r\n                console.log(\"server response:\", serverResponse);\r\n                if (serverResponse.status === 200) {\r\n                    console.log(serverResponse.data);\r\n                    this.showToast(serverResponse.data, 'Success', 'success');\r\n                } else {\r\n                    this.handleError(serverResponse);\r\n                }\r\n            } catch (error) {\r\n                this.handleError(error);\r\n            }\r\n        },\r\n\r\n        showToast(message, title, variant) {\r\n            this.$bvToast.toast(message, {\r\n                title,\r\n                variant,\r\n                solid: true\r\n            });\r\n        },\r\n\r\n        handleError(error) {\r\n            console.error('Error updating favorite status:', error);\r\n            this.showToast('Error updating favorite status', 'Error', 'danger');\r\n        },\r\n        \r\n        async addFavorite() {\r\n            const username = this.$root.store.username;\r\n            const recipeId = this.recipe.id;\r\n            console.log(username, recipeId);\r\n            const response = await this.axios.post(this.$root.store.server_domain + '/users/favorites', {\r\n                \"username\":username,\r\n                \"recipeId\":recipeId\r\n            });\r\n            return response;\r\n        },\r\n        async deleteFavorite() {\r\n            const username = this.$root.store.username;\r\n            const recipeId = this.recipe.id;\r\n            console.log(username, recipeId);\r\n            const response = await this.axios.delete(this.$root.store.server_domain + '/users/favorites', {\r\n                data: { // 'data' is needed to send the body in DELETE requests\r\n                    \"username\": username,\r\n                    \"recipeId\": recipeId\r\n            }});\r\n            return response;\r\n        }\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.vegan,\r\n.glutenFree,\r\n.vegi {\r\n  width: 30px;\r\n  height: auto;\r\n}\r\n.favorite-icon\r\n{\r\n  width: 30px;\r\n  height: auto;\r\n  margin-top: 5px;\r\n}\r\n\r\n.custom-checkbox {\r\n  opacity: 0; /* Make it invisible */\r\n  width: 0;\r\n  height: 0;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}